<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Learning - YouTube Subtitle Trainer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéì English Learning</h1>
            <p class="subtitle">Study English with YouTube videos and synced subtitles</p>
            <div class="header-actions">
                <div class="stats-display" id="statsDisplay">
                    <div class="stats-item">
                        <span class="stats-label">üë• Users:</span>
                        <span class="stats-value" id="totalUsers">--</span>
                    </div>
                    <div class="stats-item">
                        <span class="stats-label">‚è±Ô∏è Total time:</span>
                        <span class="stats-value" id="totalTime">--</span>
                    </div>
                    <div class="stats-item">
                        <span class="stats-label">üü¢ Online:</span>
                        <span class="stats-value" id="onlineUsers">--</span>
                    </div>
                </div>
                <div class="nickname-display" id="nicknameDisplay" style="display: none;">
                    <span id="currentNickname"></span>
                    <button id="changeNicknameBtn" class="change-nickname-btn" title="Change nickname">üîÑ</button>
                </div>
                <div class="theme-selector-container">
                    <label for="themeSelect" class="theme-label">üé® Theme:</label>
                    <select id="themeSelect" class="theme-select">
                        <option value="default">Default (Purple)</option>
                        <option value="blue">Calm Blue</option>
                        <option value="green">Natural Green</option>
                        <option value="orange">Energetic Orange</option>
                        <option value="dark">Professional Dark</option>
                    </select>
                </div>
                <button id="leaderboardBtn" class="leaderboard-btn">üèÜ Leaderboard</button>
                <button id="learningRecordsBtn" class="learning-records-btn">üìä Learning Records</button>
                <button id="wordBankBtn" class="word-bank-btn">üìö Word Banks</button>
            </div>
        </header>

        <div class="input-section">
            <div class="url-input-container">
                <div class="url-input-wrapper">
                    <input
                        type="text"
                        id="youtubeUrl"
                        placeholder="Enter a YouTube URL, e.g. https://www.youtube.com/watch?v=VIDEO_ID"
                        class="url-input"
                    >
                    <div class="bookmark-dropdown-container">
                        <button id="bookmarkBtn" class="bookmark-btn" title="Bookmarks">üîñ</button>
                        <div id="bookmarkDropdown" class="bookmark-dropdown" style="display: none;">
                            <div class="bookmark-header">
                                <span>Bookmarks</span>
                                <div class="bookmark-header-actions">
                                    <button id="exportBookmarksBtn" class="bookmark-action-btn" title="Export bookmarks">üì•</button>
                                    <button id="importBookmarksBtn" class="bookmark-action-btn" title="Import bookmarks">üì§</button>
                                    <button id="addBookmarkBtn" class="add-bookmark-btn" title="Add current URL">+</button>
                                </div>
                            </div>
                            <input type="file" id="importBookmarkFileInput" accept=".json" style="display: none;">
                            <div id="bookmarkList" class="bookmark-list">
                                <p class="placeholder">Loading...</p>
                            </div>
                        </div>
                    </div>
                </div>
                <button id="loadVideo" class="load-btn">Load Video</button>
            </div>
        </div>

        <div id="errorMessage" class="error-message" style="display: none;"></div>

        <div id="videoSection" class="video-section" style="display: none;">
            <div class="video-container">
                <div id="player"></div>
            </div>
            
            <div class="subtitles-container">
                <div class="subtitle-header">
                    <h5>Subtitles</h5>
                    <button id="subtitleControlsToggle" class="subtitle-controls-toggle" title="Expand/Collapse controls">
                        <span class="triangle-icon"></span>
                    </button>
                    <div class="subtitle-controls" id="subtitleControls">
                        <label>
                            <input type="checkbox" id="autoScroll" checked> Auto scroll
                        </label>
                        <label>
                            <input type="checkbox" id="showEnglish" checked> Show English
                        </label>
                        <label>
                            <input type="checkbox" id="showChinese" checked> Show Chinese
                        </label>
                        <label>
                            <input type="checkbox" id="wordHighlight" checked> Highlight words
                        </label>
                        <div class="time-offset-control">
                            <label>Time offset:</label>
                            <button id="offsetMinus" class="offset-btn">-0.5s</button>
                            <span id="offsetValue">0.0s</span>
                            <button id="offsetPlus" class="offset-btn">+0.5s</button>
                            <button id="offsetReset" class="offset-btn">Reset</button>
                        </div>
                        <div class="video-size-control">
                            <label>Video size:</label>
                            <select id="videoSizeSelect" class="size-select">
                                <option value="small">Small</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                        <div class="subtitle-lines-control">
                            <label>Subtitle lines:</label>
                            <select id="subtitleLinesSelect" class="lines-select">
                                <option value="small">Few</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Many</option>
                            </select>
                        </div>
                        <div class="subtitle-font-size-control">
                            <label>Font size:</label>
                            <select id="fontSizeSelect" class="font-size-select">
                                <option value="small">Small</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                        <div class="layout-control">
                            <label>Layout:</label>
                            <select id="layoutSelect" class="layout-select">
                                <option value="side-by-side" selected>Side by side</option>
                                <option value="stacked">Stacked</option>
                            </select>
                        </div>
                        <div class="width-control">
                            <label>Container width:</label>
                            <select id="containerWidth" class="width-select">
                                <option value="1200">1200px (narrow)</option>
                                <option value="1400" selected>1400px (medium)</option>
                                <option value="1600">1600px (wide)</option>
                                <option value="1800">1800px (extra wide)</option>
                                <option value="100">100% (full width)</option>
                            </select>
                        </div>
                        <div class="playback-speed-control">
                            <label>Playback speed:</label>
                            <select id="playbackSpeed" class="playback-speed-select">
                                <option value="0.25">0.25x</option>
                                <option value="0.5">0.5x</option>
                                <option value="0.75">0.75x</option>
                                <option value="1" selected>1x (normal)</option>
                                <option value="1.25">1.25x</option>
                                <option value="1.5">1.5x</option>
                                <option value="1.75">1.75x</option>
                                <option value="2">2x</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div id="subtitles" class="subtitles-content">
                    <p class="placeholder">Loading subtitles...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂñÆÂ≠óË≥áË®ä Modal -->
    <div id="wordModal" class="word-modal" style="display: none;">
        <div class="word-modal-content">
            <div class="word-modal-header">
                <h2 id="wordModalTitle">Word details</h2>
                <button class="word-modal-close" id="wordModalClose">&times;</button>
            </div>
            <div class="word-modal-body" id="wordModalBody">
                <div class="loading-spinner">Loading...</div>
            </div>
            <div class="word-modal-footer" id="wordModalFooter" style="display: none;">
                <div class="add-to-bank-section">
                    <label for="bankSelect">Add to word bank:</label>
                    <select id="bankSelect" class="bank-select">
                        <option value="">Choose a word bank...</option>
                    </select>
                    <button id="addToBankBtn" class="add-to-bank-btn">Add</button>
                    <button id="createBankBtn" class="create-bank-btn">Create new bank</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂñÆÂ≠óÂ∫´ÁÆ°ÁêÜ Modal -->
    <div id="wordBankModal" class="word-modal" style="display: none;">
        <div class="word-modal-content word-bank-modal-content">
            <div class="word-modal-header">
                <h2>üìö Word Bank Management</h2>
                <button class="word-modal-close" id="wordBankModalClose">&times;</button>
            </div>
            <div class="word-modal-body">
                <div class="word-bank-tabs">
                    <button class="tab-btn active" data-tab="list">Word bank list</button>
                    <button class="tab-btn" data-tab="review">Review words</button>
                </div>

                <!-- ÂñÆÂ≠óÂ∫´ÂàóË°® -->
                <div id="bankListTab" class="tab-content active">
                    <div class="bank-list-header">
                        <button id="createNewBankBtn" class="create-new-bank-btn">+ Create word bank</button>
                        <button id="exportBanksBtn" class="export-banks-btn">üì• Export</button>
                        <button id="importBanksBtn" class="import-banks-btn">üì§ Import</button>
                        <input type="file" id="importFileInput" accept=".json" style="display: none;">
                    </div>
                    <div id="bankList" class="bank-list">
                        <div class="loading-spinner">Loading...</div>
                    </div>
                </div>

                <!-- Ë§áÁøíÂñÆÂ≠ó -->
                <div id="reviewTab" class="tab-content">
                    <div class="review-controls">
                        <label>Select a word bank:</label>
                        <select id="reviewBankSelect" class="bank-select">
                            <option value="">Choose a word bank...</option>
                        </select>
                        <div class="review-mode-controls">
                            <label>Review mode:</label>
                            <div class="review-mode-buttons">
                                <button id="spacedReviewBtn" class="review-mode-btn active" data-mode="spaced">Spaced repetition</button>
                                <button id="randomReviewBtn" class="review-mode-btn" data-mode="random">Random review</button>
                                <button id="fillInBlankBtn" class="review-mode-btn" data-mode="fill-in-blank">Fill in the blank</button>
                            </div>
                        </div>
                        <button id="startReviewBtn" class="start-review-btn">Start reviewing</button>
                    </div>
                    <div id="reviewContent" class="review-content">
                        <p class="placeholder">Choose a word bank to start reviewing</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂñÆÂ≠óÂ∫´ÂÖßÂÆπ Modal -->
    <div id="bankContentModal" class="word-modal" style="display: none;">
        <div class="word-modal-content">
            <div class="word-modal-header">
                <h2 id="bankContentTitle">Word bank contents</h2>
                <button class="word-modal-close" id="bankContentModalClose">&times;</button>
            </div>
            <div class="word-modal-body">
                <div id="bankContent" class="bank-content">
                    <div class="loading-spinner">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Â≠∏ÁøíË®òÈåÑ Modal -->
    <div id="learningRecordsModal" class="word-modal" style="display: none;">
        <div class="word-modal-content">
            <div class="word-modal-header">
                <h2>üìä Learning history & progress</h2>
                <button class="word-modal-close" id="learningRecordsModalClose">&times;</button>
            </div>
            <div class="word-modal-body">
                <div class="records-tabs">
                    <button class="tab-btn active" data-tab="history">Learning history</button>
                    <button class="tab-btn" data-tab="progress">Learning progress</button>
                    <button class="tab-btn" data-tab="stats">Learning stats</button>
                </div>

                <!-- Â≠∏ÁøíÊ≠∑Âè≤ -->
                <div id="historyTab" class="tab-content active">
                    <div id="learningHistory" class="learning-history">
                        <div class="loading-spinner">Loading...</div>
                    </div>
                </div>

                <!-- Â≠∏ÁøíÈÄ≤Â∫¶ -->
                <div id="progressTab" class="tab-content">
                    <div class="progress-controls">
                        <label>Select a word bank:</label>
                        <select id="progressBankSelect" class="bank-select">
                            <option value="">Choose a word bank...</option>
                        </select>
                        <button id="loadProgressBtn" class="load-progress-btn">Load progress</button>
                    </div>
                    <div id="learningProgress" class="learning-progress">
                        <p class="placeholder">Select a word bank to view progress</p>
                    </div>
                </div>

                <!-- Â≠∏ÁøíÁµ±Ë®à -->
                <div id="statsTab" class="tab-content">
                    <div id="learningStats" class="learning-stats">
                        <div class="loading-spinner">Loading...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Êö±Á®±Ëº∏ÂÖ• Modal -->
    <div id="nicknameModal" class="word-modal" style="display: none;">
        <div class="word-modal-content nickname-modal-content">
            <div class="word-modal-header">
                <h2>üë§ Welcome to the English learning tool</h2>
            </div>
            <div class="word-modal-body">
                <div class="nickname-input-section">
                    <label for="nicknameInput">Please enter your nickname:</label>
                    <input type="text" id="nicknameInput" class="nickname-input" placeholder="Enter nickname..." maxlength="20">
                    <p class="nickname-hint">Your nickname stores personal bookmarks and word banks.</p>
                </div>
            </div>
            <div class="word-modal-footer">
                <button id="confirmNicknameBtn" class="confirm-nickname-btn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- ÊéíË°åÊ¶ú Modal -->
    <div id="leaderboardModal" class="word-modal" style="display: none;">
        <div class="word-modal-content">
            <div class="word-modal-header">
                <h2>üèÜ Learning leaderboard</h2>
                <button class="word-modal-close" id="leaderboardModalClose">&times;</button>
            </div>
            <div class="word-modal-body">
                <div class="leaderboard-tabs">
                    <button class="tab-btn active" data-tab="learning-time">üìñ Study time</button>
                    <button class="tab-btn" data-tab="review-score">üéØ Review scores</button>
                    <button class="tab-btn" data-tab="bookmarks">üîñ Bookmarks</button>
                </div>

                <!-- Â≠∏ÁøíÊôÇÈñìÊéíË°åÊ¶ú -->
                <div id="learningTimeTab" class="tab-content active">
                    <div id="learningTimeLeaderboard" class="leaderboard-content">
                        <div class="loading-spinner">Loading...</div>
                    </div>
                </div>

                <!-- Ë§áÁøíÊàêÁ∏æÊéíË°åÊ¶ú -->
                <div id="reviewScoreTab" class="tab-content">
                    <div id="reviewScoreLeaderboard" class="leaderboard-content">
                        <div class="loading-spinner">Loading...</div>
                    </div>
                </div>

                <!-- Êõ∏Á±§ÊéíË°åÊ¶ú -->
                <div id="bookmarksTab" class="tab-content">
                    <div id="bookmarksLeaderboard" class="leaderboard-content">
                        <div class="loading-spinner">Loading...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‰ΩúËÄÖË≥áË®ä Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="author-info">
                <p>¬© 2025 English Learning | Developer: <strong>Craig Huang</strong> | Contact: <a href="mailto:craig7351@gmail.com">craig7351@gmail.com</a></p>
            </div>
        </div>
    </footer>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>

